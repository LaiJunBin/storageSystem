<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>倉儲系統</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
    crossorigin="anonymous">
  <link href="./css/main.css" rel="stylesheet">
  <link rel="stylesheet" href="./js/jquery/jquery-ui.css">
  <link rel="stylesheet" href="./js/jquery/jquery-ui.theme.css">
  <link rel="stylesheet" href="./js/jquery/jquery-ui.structure.css">
</head>
  <script src="./js/jquery/external/jquery-3.2.1.min.js"></script>
  <script src="./js/jquery/jquery-ui.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
    crossorigin="anonymous"></script>
    <script>
      function includeJs(path){
        var script = document.createElement("script");
        var body = document.getElementsByTagName("body")[0];
        script.src=path;
        body.append(script);
      }
    </script>
<body>

  <div class="site-wrapper">

    <div class="site-wrapper-inner">

      <div class="cover-container">

        <header class="masthead clearfix">
          <div class="inner">
            <h3 class="masthead-brand">穀保家商餐飲管理科<br>倉儲系統</h3>
            <nav class="nav nav-masthead">
              <a class="nav-link" href="#" va="home">主頁面</a>
              <span class="space2">&nbsp;&nbsp;</span>
              
              <script>
                $.ajax({
                  url: './database/checkLogin.php',
                  type: 'POST',
                  data: {
                    autoLoginValue: localStorage['autoLogin'],
                  },
                  error: function (xhr) {
                    reload();
                  },
                  success: function (result) {
                    if (result) {
                      $(".nav-masthead").append("<a class=nav-link href=# va=manageClassName>管理教室</a>");
                      $(".nav-masthead").append("<a class=nav-link href=# va=manageItem>管理物品</a>");
                      $(".nav-masthead").append("<a class=nav-link href=# va=LogOut>登出</a>");
                      $("#purchase").append("<a href=# class='btn btn-lg btn-secondary' va=purchase>進貨</a>");
                      $.ajax({
                        url: "data/loginOption.html",
                        method:"POST",
                        success:function(result){
                            $($("footer").prev()).append(result);
                            var availableTags;
                            $.ajax({
                                url: './database/select.php',
                                type: 'POST',
                                data: {
                                    table: "storage_classlist",
                                    target: "sc_className",
                                    match:"",
                                    all:"true",
                                },
                                error: function (xhr) {
                                    reload();
                                },
                                success: function (result) {
                                    localStorage['temp']=result;
                                }
                            });
                            availableTags=localStorage['temp'].split(",");
                            $("div[type=removeClassName] input[name=className]").autocomplete({
                                source: availableTags
                            });
                            $.ajax({
                                url: './database/select.php',
                                type: 'POST',
                                data: {
                                    table: "storage_itemlist",
                                    target: "si_item",
                                    match:"",
                                    all:"true",
                                },
                                error: function (xhr) {
                                    reload();
                                },
                                success: function (result) {
                                    localStorage['temp2']=result;
                                }
                            });
                            availableTags=localStorage['temp2'].split(",");
                            $("div[type=removeItem] input[name=item]").autocomplete({
                                source: availableTags
                            });
                        },
                      });
                      $.ajax({
                          url: './database/createClassSet.php',
                          error: function (xhr) {
                              reload();
                          },
                          success: function (result) {
                              $("#classSet").append(result);
                              $.ajax({
                                url: './database/createItemSet.php',
                                error: function (xhr) {
                                    reload();
                                },
                                success: function (result) {
                                    $("#itemSet").append(result);
                                    if($("#itemSet input").length>0 && $("#classSet input").length>0){
                                      $("div[type=purchase] form").append("<p class=lead><input class=form-control required type=text name=amount placeholder=請輸入數量></p>");
                                      $("div[type=purchase] form").append("<p class=lead><button type=submit class='btn btn-dark Btn'>進貨</button></p>");
                                    }
                                }
                            });
                          }
                      });
                    } else {
                      $(".nav-masthead").append("<a class=nav-link href=# va=Login>登入</a>");
                      includeJs("./js/main.js");
                      $.ajax({
                        url: "data/login.html",
                        method:"POST",
                        success:function(result){
                            $($("footer").prev()).append(result);
                        },
                      });
                    }
                    $.ajax({
                          url: './database/createSearchItem.php',
                          error: function (xhr) {
                              reload();
                          },
                          success: function (result) {
                              $("#accordion").append(result);
                              includeJs("./js/main.js");
                              includeJs("./js/jquery/jquery-ui.min.js");
                          }
                      });
                  }
                });
              </script>

            </nav>
          </div>
        </header>

        <div type="home" class="inner cover content">
          <h1 class="cover-heading">操　　作</h1>
          <p class="lead" id="purchase">
            
          </p>
          <p class="lead">
            <a href="#" class="btn btn-lg btn-secondary" va="stock">庫存量</a>
          </p>
        </div>
        <div type="stock" class="inner cover content">
          <h1 class="cover-heading">選擇查看方式</h1>
          <p class="lead">
            <a href="#" class="btn btn-lg btn-secondary" va="classSearch">以教室</a>
          </p>
          <p class="lead">
            <a href="#" class="btn btn-lg btn-secondary" va="itemSearch">以物品</a>
          </p>
        </div>
        <div type="classSearch" class="inner cover content">
            <h1 class="cover-heading">以教室查看</h1>
              <div id="accordion">
                
              </div>
          </div>
          <div></div>
        <footer class="mastfoot">
          <div class="inner">
            <p>本系統由<a href="http://dp.kpvs.ntpc.edu.tw/bin/home.php">資料處理科</a>賴俊賓製作, <a href="https://github.com/xyz607xx">@Github</a>.</p>
          </div>
        </footer>

      </div>

    </div>

  </div>
</body>
</html>